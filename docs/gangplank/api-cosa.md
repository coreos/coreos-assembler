<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# cosa

```go
import "github.com/coreos/gangplank/cosa"
```

## Index

- [Constants](<#constants>)
- [Variables](<#variables>)
- [func BuilderArch() string](<#func-builderarch>)
- [func CanArtifact(artifact string) bool](<#func-canartifact>)
- [func GetCommandBuildableArtifacts() []string](<#func-getcommandbuildableartifacts>)
- [func IsMetaJSON(path string) bool](<#func-ismetajson>)
- [func Open(p string) (io.ReadCloser, error)](<#func-open>)
- [func SetArch(a string)](<#func-setarch>)
- [func SetIOBackendFile()](<#func-setiobackendfile>)
- [func SetIOBackendMinio(ctx context.Context, m *minio.Client) error](<#func-setiobackendminio>)
- [func SetSchemaFromFile(r io.Reader) error](<#func-setschemafromfile>)
- [func defaultWalkFunc(p string) <-chan fileInfo](<#func-defaultwalkfunc>)
- [func init()](<#func-init>)
- [type AdvisoryDiff](<#type-advisorydiff>)
- [type AdvisoryDiffItems](<#type-advisorydiffitems>)
- [type AliyunImage](<#type-aliyunimage>)
- [type Amis](<#type-amis>)
- [type Artifact](<#type-artifact>)
- [type Build](<#type-build>)
  - [func ParseBuild(path string) (*Build, error)](<#func-parsebuild>)
  - [func ReadBuild(dir, buildID, arch string) (*Build, string, error)](<#func-readbuild>)
  - [func buildParser(r io.Reader) (*Build, error)](<#func-buildparser>)
  - [func (build *Build) GetArtifact(artifact string) (*Artifact, error)](<#func-build-getartifact>)
  - [func (build *Build) IsArtifact(path string) (string, bool)](<#func-build-isartifact>)
  - [func (build *Build) Validate() []error](<#func-build-validate>)
  - [func (build *Build) WriteMeta(path string, validate bool) error](<#func-build-writemeta>)
  - [func (build *Build) artifacts() map[string]*Artifact](<#func-build-artifacts>)
  - [func (b *Build) mergeMeta(r io.Reader) error](<#func-build-mergemeta>)
- [type BuildArtifacts](<#type-buildartifacts>)
- [type Cloudartifact](<#type-cloudartifact>)
- [type Extensions](<#type-extensions>)
  - [func (e *Extensions) toArtifact() *Artifact](<#func-extensions-toartifact>)
- [type Gcp](<#type-gcp>)
- [type Git](<#type-git>)
- [type Image](<#type-image>)
- [type Koji](<#type-koji>)
- [type PackageSetDifferences](<#type-packagesetdifferences>)
- [type PackageSetDifferencesItems](<#type-packagesetdifferencesitems>)
- [type build](<#type-build>)
- [type buildsJSON](<#type-buildsjson>)
  - [func getBuilds(dir string) (*buildsJSON, error)](<#func-getbuilds>)
  - [func (b *buildsJSON) getLatest(arch string) (string, bool)](<#func-buildsjson-getlatest>)
- [type fileInfo](<#type-fileinfo>)
- [type fileMode](<#type-filemode>)
- [type ioBackendFile](<#type-iobackendfile>)
  - [func (i *ioBackendFile) Name() string](<#func-iobackendfile-name>)
  - [func (i *ioBackendFile) Open(p string) (io.ReadCloser, error)](<#func-iobackendfile-open>)
- [type ioBackendMinio](<#type-iobackendminio>)
  - [func (im *ioBackendMinio) Open(p string) (io.ReadCloser, error)](<#func-iobackendminio-open>)
- [type ioBackender](<#type-iobackender>)
  - [func newBackend() ioBackender](<#func-newbackend>)
- [type objectInfo](<#type-objectinfo>)
  - [func (ao *objectInfo) IsDir() bool](<#func-objectinfo-isdir>)
  - [func (ao *objectInfo) ModTime() time.Time](<#func-objectinfo-modtime>)
  - [func (ao *objectInfo) Mode() fileMode](<#func-objectinfo-mode>)
  - [func (ao *objectInfo) Name() string](<#func-objectinfo-name>)
  - [func (ao *objectInfo) Size() int64](<#func-objectinfo-size>)
  - [func (ao *objectInfo) Sys() interface{}](<#func-objectinfo-sys>)
- [type walkerFn](<#type-walkerfn>)
  - [func createMinioWalkFunc(m *minio.Client) walkerFn](<#func-createminiowalkfunc>)


## Constants

```go
const (
    // CosaBuildsJSON is the COSA build.json file name
    CosaBuildsJSON = "builds.json"
)
```

```go
const (
    // CosaMetaJSON is the meta.json file
    CosaMetaJSON = "meta.json"
)
```

## Variables

```go
var (
    // ErrMetaFailsValidation is thrown on reading and invalid meta.json
    ErrMetaFailsValidation = errors.New("meta.json failed schema validation")

    // ErrMetaNotFound is thrown when a meta.json cannot be found
    ErrMetaNotFound = errors.New("meta.json was not found")

    // reMetaJSON matches meta.json files use for merging
    reMetaJSON = regexp.MustCompile(`^meta\.(json|.*\.json)$`)

    // forceArch when not empty will override the build arch
    forceArch, _ = os.LookupEnv("COSA_FORCE_ARCH")
)
```

```go
var (
    // ErrNoBuildsFound is thrown when a build is missing
    ErrNoBuildsFound = errors.New("no COSA builds found")
)
```

```go
var ErrNoMinioClient = errors.New("minio client is not defined")
```

```go
var (
    // SchemaJSON Schema document. Default the generated Schema.
    SchemaJSON = generatedSchemaJSON
)
```

```go
var generatedSchemaJSON = `{
 "definitions": {
     "artifact": {
         "type": "object",
         "properties": {
           "path": {
             "$id": "#/artifact/Path",
             "type":"string",
             "title":"Path"
            },
           "sha256": {
             "$id": "#/artifact/sha256",
             "type":"string",
             "title":"SHA256"
            },
           "size": {
             "$id": "#/artifact/size",
             "type":"number",
             "title":"Size in bytes"
            },
           "uncompressed-sha256": {
             "$id": "#/artifact/uncompressed-sha256",
             "type":"string",
             "title":"Uncompressed SHA256"
            },
           "uncompressed-size": {
             "$id": "#/artifact/uncompressed-size",
             "type":"integer",
             "title":"Uncompressed-size"
            }
          },
          "optional": [
              "size",
              "uncompressed-sha256",
              "uncompressed-size"
          ],
          "required": [
              "path",
              "sha256"
          ]
        },
     "image": {
         "type": "object",
         "required": [
             "digest",
             "image"
         ],
         "optional": [
             "comment"
         ],
         "properties": {
           "digest": {
             "$id": "#/image/digest",
             "type":"string",
             "title":"Digest"
            },
           "comment": {
             "$id": "#/image/comment",
             "type":"string",
             "title":"Comment"
            },
           "image": {
             "$id": "#/image/image",
             "type":"string",
             "title":"Image"
            }
          }
      },
      "cloudartifact": {
         "type": "object",
         "required": [
             "image",
             "url"
         ],
         "properties": {
           "image": {
             "$id":"#/cloudartifact/image",
             "type":"string",
             "title":"Image"
            },
           "url": {
             "$id":"#/cloudartifact/url",
             "type":"string",
             "title":"URL"
            }
          }
     },
     "git": {
         "type": "object",
         "required": [
             "commit",
             "origin"
         ],
         "optional": [
             "branch",
             "dirty"
         ],
         "properties": {
           "branch": {
             "$id":"#/git/branch",
             "type":"string",
             "title":"branch",
             "default":"",
             "examples": [
               "HEAD"
              ],
             "minLength": 3
            },
           "commit": {
             "$id":"#/git/commit",
             "type":"string",
             "title":"commit",
             "default":"",
             "examples": [
               "742edc307e58f35824d906958b6493510e12b593"
              ],
             "minLength": 5
           },
           "dirty": {
             "$id":"#/git/dirty",
             "type":"string",
             "title":"dirty",
             "default":"",
             "examples": [
               "true"
              ],
             "minLength": 1
           },
           "origin": {
             "$id":"#/git/origin",
             "type":"string",
             "title":"origin",
             "default":"",
             "examples": [
               "https://github.com/coreos/fedora-coreos-config"
              ],
             "minLength": 1
            }
          }
     },
     "pkg-items": {
       "type":"array",
       "title":"Package Set differences",
       "items": {
         "$id":"#/pkgdiff/items/item",
         "title":"Items",
         "default":"",
         "minLength": 1
        }
      },
     "advisory-items": {
       "type":"array",
       "title":"Advisory diff",
       "items": {
         "$id":"#/advisory-diff/items/item",
         "title":"Items",
         "default":""
        }
      }
 },
 "$schema":"http://json-schema.org/draft-07/schema#",
 "$id":"http://github.com/coreos/coreos-assembler/blob/main/schema/v1.json",
 "type":"object",
 "title":"CoreOS Assember v1 meta.json schema",
 "required": [
     "buildid",
     "name",
     "ostree-commit",
     "ostree-content-checksum",
     "ostree-timestamp",
     "ostree-version",
     "rpm-ostree-inputhash",
     "summary"
 ],
 "optional": [
   "aliyun",
   "amis",
   "azure",
   "azurestack",
   "build-url",
   "digitalocean",
   "exoscale",
   "gcp",
   "ibmcloud",
   "images",
   "oscontainer",
   "extensions",
   "parent-pkgdiff",
   "pkgdiff",
   "parent-advisories-diff",
   "advisories-diff",
   "release-payload",

   "coreos-assembler.basearch",
   "coreos-assembler.build-timestamp",
   "coreos-assembler.code-source",
   "coreos-assembler.config-dirty",
   "coreos-assembler.config-gitrev",
   "coreos-assembler.container-config-git",
   "coreos-assembler.container-image-git",
   "coreos-assembler.delayed-meta-merge",
   "coreos-assembler.image-config-checksum",
   "coreos-assembler.image-genver",
   "coreos-assembler.image-input-checksum",
   "coreos-assembler.meta-stamp",
   "coreos-assembler.overrides-active",
   "fedora-coreos.parent-commit",
   "fedora-coreos.parent-version",
   "ref"
 ],
 "additionalProperties":false,
 "properties": {
   "ref": {
     "$id":"#/properties/ref",
     "type":"string",
     "title":"BuildRef",
     "default":"",
     "minLength": 1
    },
   "build-url": {
     "$id":"#/properties/build-url",
     "type":"string",
     "title":"Build URL",
     "default":"",
     "minLength": 1
    },
   "buildid": {
     "$id":"#/properties/buildid",
     "type":"string",
     "title":"BuildID",
     "default":"",
     "minLength": 1
    },
   "coreos-assembler.basearch": {
     "$id":"#/properties/coreos-assembler.basearch",
     "type":"string",
     "title":"Architecture",
     "default":"",
     "minLength": 1
    },
   "coreos-assembler.build-timestamp": {
     "$id":"#/properties/coreos-assembler.build-timestamp",
     "type":"string",
     "title":"Build Time Stamp",
     "default":"",
     "minLength": 1
    },
   "coreos-assembler.code-source": {
     "$id":"#/properties/coreos-assembler.code-source",
     "type":"string",
     "title":"CoreOS Source",
     "default":"",
     "minLength": 1
    },
   "coreos-assembler.config-dirty": {
     "$id":"#/properties/coreos-assembler.config-dirty",
     "type":"string",
     "title":"GitDirty",
     "default":"",
     "minLength": 1
    },
   "coreos-assembler.config-gitrev": {
     "$id":"#/properties/coreos-assembler.config-gitrev",
     "type":"string",
     "title":"Config GitRev",
     "default":"",
     "minLength": 1
    },
   "coreos-assembler.container-config-git": {
     "$id":"#/properties/coreos-assembler.container-config-git",
     "type":"object",
     "title":"Container Config GIT",
     "$ref": "#/definitions/git"
    },
   "coreos-assembler.container-image-git": {
     "$id":"#/properties/coreos-assembler.container-image-git",
     "type":"object",
     "title":"COSA Container Image Git",
     "$ref": "#/definitions/git"
    },
   "coreos-assembler.delayed-meta-merge": {
     "$id":"#/properties/coreos-assembler.delayed-meta-merge",
     "type":"boolean",
     "title":"COSA Delayed Meta Merge",
     "default": "False"
    },
   "coreos-assembler.meta-stamp": {
     "$id":"#/properties/coreos-assembler.meta-stamp",
     "type":"number",
     "title":"Meta Stamp",
     "default":"",
     "minLength": 16
    },
    "fedora-coreos.parent-version": {
     "$id":"#/properties/fedora-coreos.parent-version",
     "type":"string",
     "title":"Fedora CoreOS Parent Version",
     "default":"",
     "minLength": 12
    },
    "fedora-coreos.parent-commit": {
     "$id":"#/properties/fedora-coreos.parent-commit",
     "type":"string",
     "title":"Fedora CoreOS parent commit",
     "default":"",
     "examples": [
       "f15f5b25cf138a7683e3d200c53ece2091bf71d31332135da87892ab72ff4ee3"
      ],
     "minLength": 64
    },
   "coreos-assembler.image-config-checksum": {
     "$id":"#/properties/coreos-assembler.image-config-checksum",
     "type":"string",
     "title":"COSA image checksum",
     "default":"",
     "minLength": 64
    },
   "coreos-assembler.image-genver": {
     "$id":"#/properties/coreos-assembler.image-genver",
     "type":"integer",
     "title":"COSA Image Version",
     "default": 0,
     "examples": [
        0
      ]
    },
   "coreos-assembler.image-input-checksum": {
     "$id":"#/properties/coreos-assembler.image-input-checksum",
     "type":"string",
     "title":"Image input checksum",
     "default":"",
     "minLength": 64
    },
   "coreos-assembler.overrides-active": {
     "$id":"#/properties/coreos-assembler.overrides-active",
     "title":"Overrides Active",
     "default":"",
     "type": "boolean"
    },
   "images": {
     "$id":"#/properties/images",
     "type":"object",
     "title":"Build Artifacts",
     "required": [
       "ostree"
      ],
     "optional": [
       "aliyun",
       "aws",
       "azure",
       "azurestack",
       "dasd",
       "digitalocean",
       "exoscale",
       "gcp",
       "ibmcloud",
       "initramfs",
       "iso",
       "kernel",
       "live-kernel",
       "live-initramfs",
       "live-iso",
       "live-rootfs",
       "metal",
       "metal4k",
       "openstack",
       "qemu",
       "vmware",
       "vultr"
      ],
     "properties": {
       "ostree": {
         "$id":"#/properties/images/properties/ostree",
         "type":"object",
         "title":"OSTree",
         "$ref": "#/definitions/artifact"
        },
       "dasd": {
         "$id":"#/properties/images/properties/dasd",
         "type":"object",
         "title":"dasd",
         "$ref": "#/definitions/artifact"
       },
       "exoscale": {
         "$id":"#/properties/images/properties/exoscale",
         "type":"object",
         "title":"exoscale",
         "$ref": "#/definitions/artifact"
       },
       "qemu": {
         "$id":"#/properties/images/properties/qemu",
         "type":"object",
         "title":"Qemu",
         "$ref": "#/definitions/artifact"
        },
       "metal": {
         "$id":"#/properties/images/properties/metal",
         "type":"object",
         "title":"Metal",
         "$ref": "#/definitions/artifact"
        },
       "metal4k": {
         "$id":"#/properties/images/properties/metal4k",
         "type":"object",
         "title":"Metal (4K native)",
         "$ref": "#/definitions/artifact"
        },
       "iso": {
         "$id":"#/properties/images/properties/iso",
         "type":"object",
         "title":"ISO",
         "$ref": "#/definitions/artifact"
        },
       "kernel": {
         "$id":"#/properties/images/properties/kernel",
         "type":"object",
         "title":"Kernel",
         "$ref": "#/definitions/artifact"
        },
       "initramfs": {
         "$id":"#/properties/images/properties/initramfs",
         "type":"object",
         "title":"Initramfs",
         "$ref": "#/definitions/artifact"
        },
       "live-kernel": {
         "$id":"#/properties/images/properties/live-kernel",
         "type":"object",
         "title":"Live Kernel",
         "$ref": "#/definitions/artifact"
         },
       "live-initramfs": {
         "$id":"#/properties/images/properties/live-initramfs",
         "type":"object",
         "title":"Live Initramfs",
         "$ref": "#/definitions/artifact"
        },
       "live-iso": {
        "$id":"#/properties/images/properties/live-iso",
        "type":"object",
        "title":"Live ISO",
        "$ref": "#/definitions/artifact"
       },
       "live-rootfs": {
         "$id":"#/properties/images/properties/live-rootfs",
         "type":"object",
         "title":"Live Rootfs",
         "$ref": "#/definitions/artifact"
        },
       "openstack": {
         "$id":"#/properties/images/properties/openstack",
         "type":"object",
         "title":"OpenStack",
         "$ref": "#/definitions/artifact"
        },
       "vmware": {
         "$id":"#/properties/images/properties/vmware",
         "type":"object",
         "title":"VMWare",
         "$ref": "#/definitions/artifact"
        },
       "vultr": {
         "$id": "#/properties/images/properties/vultr",
         "type": "object",
         "title": "Vultr",
         "$ref": "#/definitions/artifact"
        },
       "aliyun": {
         "$id":"#/properties/images/properties/aliyun",
         "type":"object",
         "title":"Aliyun",
         "$ref": "#/definitions/artifact"
        },
       "aws": {
         "$id":"#/properties/images/properties/aws",
         "type":"object",
         "title":"AWS",
         "$ref": "#/definitions/artifact"
       },
       "azure": {
         "$id":"#/properties/images/properties/azure",
         "type":"object",
         "title":"Azure",
         "$ref": "#/definitions/artifact"
        },
       "azurestack": {
         "$id":"#/properties/images/properties/azurestack",
         "type":"object",
         "title":"AzureStack",
         "$ref": "#/definitions/artifact"
       },
       "digitalocean": {
         "$id":"#/properties/images/properties/digitalocean",
         "type":"object",
         "title":"DigitalOcean",
         "$ref": "#/definitions/artifact"
        },
       "ibmcloud": {
         "$id":"#/properties/images/properties/ibmcloud",
         "type":"object",
         "title":"IBM Cloud",
         "$ref": "#/definitions/artifact"
       },
       "gcp": {
         "$id":"#/properties/images/properties/gcp",
         "type":"object",
         "title":"GCP",
         "$ref": "#/definitions/artifact"
        }
      }
    },
   "name": {
     "$id":"#/properties/name",
     "type":"string",
     "title":"Name",
     "default":"fedora-coreos",
     "examples": [
       "rhcos",
       "fedora-coreos"
      ]
    },
   "oscontainer": {
     "$id":"#/properties/oscontainer",
     "type":"object",
     "title":"Oscontainer",
     "$ref": "#/definitions/image"
    },
   "extensions": {
     "$id":"#/properties/extensions",
     "type":"object",
     "title":"Extensions",
     "required": [
         "path",
         "sha256",
         "rpm-ostree-state",
         "manifest"
     ],
     "properties": {
       "path": {
         "$id": "#/artifact/Path",
         "type":"string",
         "title":"Path"
        },
       "sha256": {
         "$id": "#/artifact/sha256",
         "type":"string",
         "title":"SHA256"
        },
       "rpm-ostree-state": {
         "$id":"#/properties/extensions/items/properties/rpm-ostree-state",
         "type":"string",
         "title":"RpmOstreeState",
         "default":"",
         "minLength": 64
        },
       "manifest": {
         "$id":"#/properties/extensions/items/properties/manifest",
         "type":"object",
         "title":"Manifest"
       }
      }
    },
   "ostree-commit": {
     "$id":"#/properties/ostree-commit",
     "type":"string",
     "title":"ostree-commit",
     "default":"",
     "minLength": 64
    },
   "ostree-content-bytes-written": {
     "$id":"#/properties/ostree-content-bytes-written",
     "type":"integer",
     "title":"ostree-content-bytes-written",
     "default": 0
    },
   "ostree-content-checksum": {
     "$id":"#/properties/ostree-content-checksum",
     "type":"string",
     "title":"ostree-content-checksum",
     "default":"",
     "minLength": 64
    },
   "ostree-n-cache-hits": {
     "$id":"#/properties/ostree-n-cache-hits",
     "type":"integer",
     "title":"ostree-n-cache-hits",
     "default": 0
    },
   "ostree-n-content-total": {
     "$id":"#/properties/ostree-n-content-total",
     "type":"integer",
     "title":"ostree-n-content-total",
     "default": 0
    },
   "ostree-n-content-written": {
     "$id":"#/properties/ostree-n-content-written",
     "type":"integer",
     "title":"ostree-n-content-written",
     "default": 0
    },
   "ostree-n-metadata-total": {
     "$id":"#/properties/ostree-n-metadata-total",
     "type":"integer",
     "title":"ostree-n-metadata-total",
     "default": 0
    },
   "ostree-n-metadata-written": {
     "$id":"#/properties/ostree-n-metadata-written",
     "type":"integer",
     "title":"ostree-n-metadata-written",
     "default": 0
    },
   "ostree-timestamp": {
     "$id":"#/properties/ostree-timestamp",
     "type":"string",
     "title":"ostree timestamp",
     "default":"",
     "examples": [
       "2020-01-15T19:31:31Z"
      ],
     "pattern":"\\d{4}-\\d{2}-\\d{2}T.*Z$"
    },
   "ostree-version": {
     "$id":"#/properties/ostree-version",
     "type":"string",
     "title":"ostree version",
     "default":"",
     "minLength": 1
    },
   "pkgdiff": {
     "$id":"#/properties/pkgdiff",
     "type":"array",
     "title":"pkgdiff between builds",
     "$ref": "#/definitions/pkg-items"
    },
   "parent-pkgdiff": {
     "$id":"#/properties/parent-pkgdiff",
     "type":"array",
     "title":"pkgdiff against parent",
     "$ref": "#/definitions/pkg-items"
    },
   "advisories-diff": {
     "$id":"#/properties/advisories-diff",
     "type":"array",
     "title":"advisory diff between builds",
     "$ref": "#/definitions/advisory-items"
    },
   "parent-advisories-diff": {
     "$id":"#/properties/parent-advisory-diff",
     "type":"array",
     "title":"advisory diff against parent",
     "$ref": "#/definitions/advisory-items"
    },
   "rpm-ostree-inputhash": {
     "$id":"#/properties/rpm-ostree-inputhash",
     "type":"string",
     "title":"input has of the rpm-ostree",
     "default":"",
     "minLength": 64
    },
   "summary": {
     "$id":"#/properties/summary",
     "type":"string",
     "title":"Build Summary",
     "default":"",
     "minLength": 1
    },
   "aliyun": {
     "$id":"#/properties/aliyun",
     "type":"array",
     "title":"Alibaba/Aliyun Uploads",
     "items": {
       "$id":"#/properties/aliyun/images",
       "type":"object",
       "title":"Aliyun Image",
       "required": [
         "name",
         "id"
        ],
       "properties": {
         "name": {
           "$id":"#/properties/aliyun/items/properties/name",
           "type":"string",
           "title":"Region",
           "default":"",
           "minLength": 1
          },
         "id": {
           "$id":"#/properties/aliyun/items/properties/id",
           "type":"string",
           "title":"ImageID",
           "default":"",
           "minLength": 1
          }
        }
      }
    },
   "amis": {
     "$id":"#/properties/amis",
     "type":"array",
     "title":"AMIS",
     "items": {
       "$id":"#/properties/amis/items",
       "type":"object",
       "title":"AMIS",
       "required": [
         "name",
         "hvm",
         "snapshot"
        ],
       "properties": {
         "name": {
           "$id":"#/properties/amis/items/properties/name",
           "type":"string",
           "title":"Region",
           "default":""
          },
         "hvm": {
           "$id":"#/properties/amis/items/properties/hvm",
           "type":"string",
           "title":"HVM",
           "default":""
         },
         "snapshot": {
           "$id":"#/properties/amis/items/properties/snapshot",
           "type":"string",
           "title":"Snapshot",
           "default":""
          }
        }
      }
    },
   "azure": {
     "$id":"#/properties/azure",
     "type":"object",
     "title":"Azure",
     "$ref": "#/definitions/cloudartifact"
    },
   "gcp": {
     "$id":"#/properties/gcp",
     "type":"object",
     "title":"GCP",
     "required": [
         "image",
         "url"
     ],
     "optional": [
         "family",
         "project"
     ],
     "properties": {
       "image": {
         "$id":"#/properties/gcp/image",
         "type":"string",
         "title":"Image Name"
        },
       "url": {
         "$id":"#/properties/gcp/url",
         "type":"string",
         "title":"URL"
        },
       "project": {
         "$id":"#/properties/gcp/project",
         "type":"string",
         "title":"Image Project"
        },
       "family": {
         "$id":"#/properties/gcp/family",
         "type":"string",
         "title":"Image Family"
        }
      }
    },
    "release-payload": {
      "$id":"#/properties/release-payload",
      "type":"object",
      "title":"ReleasePayload",
      "$ref": "#/definitions/image"
    }
  }
}
`
```

## func BuilderArch

```go
func BuilderArch() string
```

BuilderArch converts the GOARCH to the build arch\. In other words\, it translates amd64 to x86\_64\.

## func CanArtifact

```go
func CanArtifact(artifact string) bool
```

CanArtifact reports whether an artifact name is buildable by COSA based on the meta\.json name\. CanArtifact is used to signal if the artifact is a known artifact type\.

## func GetCommandBuildableArtifacts

```go
func GetCommandBuildableArtifacts() []string
```

GetCommandBuildableArtifacts returns the string name of buildable artifacts through the \`cosa build\-\*\` CLI\.

## func IsMetaJSON

```go
func IsMetaJSON(path string) bool
```

IsMetaJSON is a helper for identifying if a file is meta\.json

## func Open

```go
func Open(p string) (io.ReadCloser, error)
```

Open calls the backend's open function\.

## func SetArch

```go
func SetArch(a string)
```

SetArch overrides the build arch

## func SetIOBackendFile

```go
func SetIOBackendFile()
```

SetIOBackendFile sets the backend to the default file backend\.

## func SetIOBackendMinio

```go
func SetIOBackendMinio(ctx context.Context, m *minio.Client) error
```

SetIOBackendMinio sets the backend to minio\. The client must be provided by the caller\, including authorization\.

## func SetSchemaFromFile

```go
func SetSchemaFromFile(r io.Reader) error
```

SetSchemaFromFile sets the validation JSON Schema

## func defaultWalkFunc

```go
func defaultWalkFunc(p string) <-chan fileInfo
```

defaultWalkFunc walks over a directory and returns a channel of os\.FileInfo

## func init

```go
func init()
```

## type AdvisoryDiff

```go
type AdvisoryDiff []AdvisoryDiffItems
```

## type AdvisoryDiffItems

```go
type AdvisoryDiffItems interface{}
```

## type AliyunImage

```go
type AliyunImage struct {
    ImageID string `json:"id"`
    Region  string `json:"name"`
}
```

## type Amis

```go
type Amis struct {
    Hvm      string `json:"hvm"`
    Region   string `json:"name"`
    Snapshot string `json:"snapshot"`
}
```

## type Artifact

```go
type Artifact struct {
    Path               string  `json:"path"`
    Sha256             string  `json:"sha256"`
    SizeInBytes        float64 `json:"size,omitempty"`
    UncompressedSha256 string  `json:"uncompressed-sha256,omitempty"`
    UncompressedSize   int     `json:"uncompressed-size,omitempty"`
}
```

## type Build

```go
type Build struct {
    AdvisoryDiffAgainstParent AdvisoryDiff          `json:"parent-advisories-diff,omitempty"`
    AdvisoryDiffBetweenBuilds AdvisoryDiff          `json:"advisories-diff,omitempty"`
    AlibabaAliyunUploads      []AliyunImage         `json:"aliyun,omitempty"`
    Amis                      []Amis                `json:"amis,omitempty"`
    Architecture              string                `json:"coreos-assembler.basearch,omitempty"`
    Azure                     *Cloudartifact        `json:"azure,omitempty"`
    BuildArtifacts            *BuildArtifacts       `json:"images,omitempty"`
    BuildID                   string                `json:"buildid"`
    BuildRef                  string                `json:"ref,omitempty"`
    BuildSummary              string                `json:"summary"`
    BuildTimeStamp            string                `json:"coreos-assembler.build-timestamp,omitempty"`
    BuildURL                  string                `json:"build-url,omitempty"`
    ConfigGitRev              string                `json:"coreos-assembler.config-gitrev,omitempty"`
    ContainerConfigGit        *Git                  `json:"coreos-assembler.container-config-git,omitempty"`
    CoreOsSource              string                `json:"coreos-assembler.code-source,omitempty"`
    CosaContainerImageGit     *Git                  `json:"coreos-assembler.container-image-git,omitempty"`
    CosaDelayedMetaMerge      bool                  `json:"coreos-assembler.delayed-meta-merge,omitempty"`
    CosaImageChecksum         string                `json:"coreos-assembler.image-config-checksum,omitempty"`
    CosaImageVersion          int                   `json:"coreos-assembler.image-genver,omitempty"`
    Extensions                *Extensions           `json:"extensions,omitempty"`
    FedoraCoreOsParentCommit  string                `json:"fedora-coreos.parent-commit,omitempty"`
    FedoraCoreOsParentVersion string                `json:"fedora-coreos.parent-version,omitempty"`
    Gcp                       *Gcp                  `json:"gcp,omitempty"`
    GitDirty                  string                `json:"coreos-assembler.config-dirty,omitempty"`
    ImageInputChecksum        string                `json:"coreos-assembler.image-input-checksum,omitempty"`
    InputHasOfTheRpmOstree    string                `json:"rpm-ostree-inputhash"`
    Koji                      *Koji                 `json:"koji,omitempty"`
    MetaStamp                 float64               `json:"coreos-assembler.meta-stamp,omitempty"`
    Name                      string                `json:"name"`
    Oscontainer               *Image                `json:"oscontainer,omitempty"`
    OstreeCommit              string                `json:"ostree-commit"`
    OstreeContentBytesWritten int                   `json:"ostree-content-bytes-written,omitempty"`
    OstreeContentChecksum     string                `json:"ostree-content-checksum"`
    OstreeNCacheHits          int                   `json:"ostree-n-cache-hits,omitempty"`
    OstreeNContentTotal       int                   `json:"ostree-n-content-total,omitempty"`
    OstreeNContentWritten     int                   `json:"ostree-n-content-written,omitempty"`
    OstreeNMetadataTotal      int                   `json:"ostree-n-metadata-total,omitempty"`
    OstreeNMetadataWritten    int                   `json:"ostree-n-metadata-written,omitempty"`
    OstreeTimestamp           string                `json:"ostree-timestamp"`
    OstreeVersion             string                `json:"ostree-version"`
    OverridesActive           bool                  `json:"coreos-assembler.overrides-active,omitempty"`
    PkgdiffAgainstParent      PackageSetDifferences `json:"parent-pkgdiff,omitempty"`
    PkgdiffBetweenBuilds      PackageSetDifferences `json:"pkgdiff,omitempty"`
    ReleasePayload            *Image                `json:"release-payload,omitempty"`
}
```

### func ParseBuild

```go
func ParseBuild(path string) (*Build, error)
```

ParseBuild parses the meta\.json and reutrns a build

### func ReadBuild

```go
func ReadBuild(dir, buildID, arch string) (*Build, string, error)
```

ReadBuild returns a build upon finding a meta\.json\. Returns a Build\, the path string to the build\, and an error \(if any\)\. If the buildID is not set\, "latest" is assumed\.

### func buildParser

```go
func buildParser(r io.Reader) (*Build, error)
```

### func \(\*Build\) GetArtifact

```go
func (build *Build) GetArtifact(artifact string) (*Artifact, error)
```

GetArtifact returns an artifact by JSON tag

### func \(\*Build\) IsArtifact

```go
func (build *Build) IsArtifact(path string) (string, bool)
```

IsArtifact takes a path and returns the artifact type and a bool if the artifact is described in the build\.

### func \(\*Build\) Validate

```go
func (build *Build) Validate() []error
```

Validate checks the build against the schema\.

### func \(\*Build\) WriteMeta

```go
func (build *Build) WriteMeta(path string, validate bool) error
```

WriteMeta records the meta\-data\. Writes are local only\.

### func \(\*Build\) artifacts

```go
func (build *Build) artifacts() map[string]*Artifact
```

artifact returns a string map of artifacts\, where the key is the JSON tag\. Reflection was over a case statement to make meta\.json and the schema authoritative for adding and removing artifacts\.

### func \(\*Build\) mergeMeta

```go
func (b *Build) mergeMeta(r io.Reader) error
```

mergeMeta uses JSON to merge in the data

## type BuildArtifacts

```go
type BuildArtifacts struct {
    Aliyun        *Artifact `json:"aliyun,omitempty"`
    Aws           *Artifact `json:"aws,omitempty"`
    Azure         *Artifact `json:"azure,omitempty"`
    AzureStack    *Artifact `json:"azurestack,omitempty"`
    Dasd          *Artifact `json:"dasd,omitempty"`
    DigitalOcean  *Artifact `json:"digitalocean,omitempty"`
    Exoscale      *Artifact `json:"exoscale,omitempty"`
    Gcp           *Artifact `json:"gcp,omitempty"`
    IbmCloud      *Artifact `json:"ibmcloud,omitempty"`
    Initramfs     *Artifact `json:"initramfs,omitempty"`
    Iso           *Artifact `json:"iso,omitempty"`
    Kernel        *Artifact `json:"kernel,omitempty"`
    LiveInitramfs *Artifact `json:"live-initramfs,omitempty"`
    LiveIso       *Artifact `json:"live-iso,omitempty"`
    LiveKernel    *Artifact `json:"live-kernel,omitempty"`
    LiveRootfs    *Artifact `json:"live-rootfs,omitempty"`
    Metal         *Artifact `json:"metal,omitempty"`
    Metal4KNative *Artifact `json:"metal4k,omitempty"`
    OpenStack     *Artifact `json:"openstack,omitempty"`
    Ostree        Artifact  `json:"ostree"`
    Qemu          *Artifact `json:"qemu,omitempty"`
    Vmware        *Artifact `json:"vmware,omitempty"`
    Vultr         *Artifact `json:"vultr,omitempty"`
}
```

## type Cloudartifact

```go
type Cloudartifact struct {
    Image string `json:"image"`
    URL   string `json:"url"`
}
```

## type Extensions

```go
type Extensions struct {
    Manifest       map[string]interface{} `json:"manifest"`
    Path           string                 `json:"path"`
    RpmOstreeState string                 `json:"rpm-ostree-state"`
    Sha256         string                 `json:"sha256"`
}
```

### func \(\*Extensions\) toArtifact

```go
func (e *Extensions) toArtifact() *Artifact
```

toArtifact converts an Extension to an Artifact

## type Gcp

```go
type Gcp struct {
    ImageFamily  string `json:"family,omitempty"`
    ImageName    string `json:"image"`
    ImageProject string `json:"project,omitempty"`
    URL          string `json:"url"`
}
```

## type Git

```go
type Git struct {
    Branch string `json:"branch,omitempty"`
    Commit string `json:"commit"`
    Dirty  string `json:"dirty,omitempty"`
    Origin string `json:"origin"`
}
```

## type Image

```go
type Image struct {
    Comment string `json:"comment,omitempty"`
    Digest  string `json:"digest"`
    Image   string `json:"image"`
}
```

## type Koji

```go
type Koji struct {
    BuildRelease string  `json:"release,omitempty"`
    KojiBuildID  float64 `json:"build_id,omitempty"`
    KojiToken    string  `json:"token,omitempty"`
}
```

## type PackageSetDifferences

```go
type PackageSetDifferences []PackageSetDifferencesItems
```

## type PackageSetDifferencesItems

```go
type PackageSetDifferencesItems interface{}
```

## type build

build represents the build struct in a buildJSON

```go
type build struct {
    ID     string   `json:"id"`
    Arches []string `json:"arches"`
}
```

## type buildsJSON

buildsJSON represents the JSON that records the builds TODO: this should be generated by a schema

```go
type buildsJSON struct {
    SchemaVersion string  `json:"schema-version"`
    Builds        []build `json:"builds"`
    TimeStamp     string  `json:"timestamp"`
}
```

### func getBuilds

```go
func getBuilds(dir string) (*buildsJSON, error)
```

### func \(\*buildsJSON\) getLatest

```go
func (b *buildsJSON) getLatest(arch string) (string, bool)
```

getLatest returns the latest build for the arch\.

## type fileInfo

```go
type fileInfo interface {
    Name() string       // base name of the file
    Size() int64        // length in bytes for regular files; system-dependent for others
    Mode() fileMode     // file mode bits
    ModTime() time.Time // modification time
    IsDir() bool        // abbreviation for Mode().IsDir()
    Sys() interface{}   // underlying data source (can return nil)
}
```

objectInfo implements the os\.FileInfo interface\. This allows for abstracting any file or object to be compared as if they were local files regardless of location\.

```go
var _ fileInfo = &objectInfo{}
```

## type fileMode

TODO: drop with GoLang 1\.16\. This is a backport of the interface from 1\.16\. var \_ os\.FileInfo = &objectInfo\{\}

```go
type fileMode uint32
```

## type ioBackendFile

ioBackendFile is a file based backend

```go
type ioBackendFile struct {
    *os.File
    path string
}
```

### func \(\*ioBackendFile\) Name

```go
func (i *ioBackendFile) Name() string
```

### func \(\*ioBackendFile\) Open

```go
func (i *ioBackendFile) Open(p string) (io.ReadCloser, error)
```

Open implements ioBackender Open interface\.

## type ioBackendMinio

ioBackendMinio is a minio based backend

```go
type ioBackendMinio struct {
    ctx  context.Context
    m    *minio.Client
    obj  *minio.Object
    name string
}
```

### func \(\*ioBackendMinio\) Open

```go
func (im *ioBackendMinio) Open(p string) (io.ReadCloser, error)
```

Open implements ioBackender's and os\.File's Open interface\.

## type ioBackender

ioBackender is the basic interface\.

```go
type ioBackender interface {
    Open(string) (io.ReadCloser, error)
}
```

ioBackendMinio is an ioBackender\.

```go
var _ ioBackender = &ioBackendMinio{}
```

default ioBackend is file backend

```go
var ioBackend ioBackender = new(ioBackendFile)
```

### func newBackend

```go
func newBackend() ioBackender
```

newBackend returns a new backend

## type objectInfo

objectInfo holds basic information about either a file object or a remote minio object\.

```go
type objectInfo struct {
    info minio.ObjectInfo
    name string
}
```

### func \(\*objectInfo\) IsDir

```go
func (ao *objectInfo) IsDir() bool
```

IsDir implements the os\.FileInfo IsDir func\. For minio objects\, the answer is always false\.

### func \(\*objectInfo\) ModTime

```go
func (ao *objectInfo) ModTime() time.Time
```

ModTime implements the os\.FileInfo ModTime func\. The returned value is remote aodification time\.

### func \(\*objectInfo\) Mode

```go
func (ao *objectInfo) Mode() fileMode
```

Mode implements the os\.FileInfo Mode func\. Since there is not simple way to convert an ACL into Unix permisions\, it blindly returns 0644\.

### func \(\*objectInfo\) Name

```go
func (ao *objectInfo) Name() string
```

Name implements the os\.FileInfo interface Name func\.

### func \(\*objectInfo\) Size

```go
func (ao *objectInfo) Size() int64
```

Size implements the os\.FileInfo size func\.

### func \(\*objectInfo\) Sys

```go
func (ao *objectInfo) Sys() interface{}
```

Sys implements the os\.FileInfo interface Sys func\. The interface spec allows for returning a nil\.

## type walkerFn

walkerFn is a function that implements the walk func

```go
type walkerFn func(string) <-chan fileInfo
```

walkFn is used to walk paths

```go
var walkFn walkerFn = defaultWalkFunc
```

### func createMinioWalkFunc

```go
func createMinioWalkFunc(m *minio.Client) walkerFn
```

createMinioWalkFunc creates a new func a minio client\. The returned function will list the remote objects and return os\.FileInfo compliant interfaces\.



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
